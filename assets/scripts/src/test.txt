function emailExists(email: string) {
  for (var i = 0; i < localStorage.length; i++) {
    const chave: string = localStorage.key(i)!;
    if (chave.includes("email")) {
      const valor: string | null = localStorage.getItem(chave);
      if (valor === email) {
        console.log("O email já existe");
        return false;
      }
    }
  }
  console.log("Email não existe");
  
  return true;
}


function getFormValues(formEl: HTMLFormElement) {
  const userItem: string | number | null = localStorage.getItem("user");
  let arrUser = [];

  if (userItem) {
    const parsedItems = JSON.parse(userItem);

    if (Array.isArray(parsedItems)) {
      arrUser = parsedItems;
    }
  }
  // CRIANDO ID

  arrUser.sort((a, b) => a.id - b.id);
  const lastItem = arrUser[arrUser.length - 1];
  const newId = lastItem ? lastItem.id + 1 : 1;
  values.id = newId;

  // PEGANDO OS DADOS DO FORM

  const form = new FormData(formEl);

  form.forEach((value, key) => {
    values[key] = value;
  });

  const { email, name, password } = values;

  // SE OS DADOS ESTÃO VÁLIDOS ARMAZENA NO LOCALSTORAGE

  if (
    validateName(name) &&
    validateEmail(email) &&
    validatePassword(password)
  ) {
    arrUser.push(values);
    localStorage.setItem("user", JSON.stringify(arrUser));
    alert("Cadastro realizado!");
    window.location.href = "auth.html";
  }
}

if (formRegister) {
  formRegister.addEventListener("submit", (e) => {
    e.preventDefault();
    getFormValues(formRegister);
  });
}
